///////////////////////////////////////////////////////////
//  ARMViewModelBase.cs
//  Implementation of the Class ARMViewModelBase
//  Generated by Enterprise Architect
//  Created on:      30-Mar-2014 6:35:57 PM
///////////////////////////////////////////////////////////

using System;
using System.ComponentModel;
using System.Linq.Expressions;
using System.Runtime.Remoting.Messaging;
using System.Threading;
using System.Windows.Threading;
using ARM.Core.Interfaces;

namespace ARM.Core.MVVM
{
    public abstract class ARMViewModelBase : IARMViewModel
    {
        ///
        /// <param name="view"></param>
        protected ARMViewModelBase(IARMView view)
        {
            View = view;
            SetDataContext();
        }

        private void SetDataContext()
        {
            if (SynchronizationContext.Current is DispatcherSynchronizationContext)
            {
                Dispatcher.CurrentDispatcher.BeginInvoke(new Action(() => this.View.DataContext = this));
            }
            else
            {
                this.View.DataContext = this;
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        ///
        /// <param name="propertyName"></param>
        protected void OnPropertyChanged(string propertyName)
        {
            var temp = PropertyChanged;
            if (temp != null)
            {
                temp(this,new PropertyChangedEventArgs(propertyName));
            }
        }

        ///
        /// <param name="exp"></param>
        protected void OnPropertyChanged<T>(Expression<Func<T>> exp)
        {
        }

        public IARMView View
        {
            get;
            protected set;
        }
    }//end ARMViewModelBase
}//end namespace MVVM