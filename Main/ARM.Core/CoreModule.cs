///////////////////////////////////////////////////////////
//  CoreModule.cs
//  Implementation of the Class CoreModule
//  Generated by Enterprise Architect
//  Created on:      31-Mar-2014 11:49:54 PM
///////////////////////////////////////////////////////////

using ARM.Core.Interfaces;
using ARM.Core.Module;
using ARM.Core.MVVM;
using ARM.Core.Service;
using ARM.Core.Validation;
using Microsoft.Practices.Prism.Events;
using Microsoft.Practices.Prism.Regions;
using Microsoft.Practices.Unity;

namespace ARM.Core
{
  /// <summary>
  /// Класс модуля загально функціоноальнгості.
  /// Реєструє загальні інтерфейси та запускає ініціалізацію кешу властивостей типів.
  /// </summary>
    public class CoreModule : ARMBaseModule
    {
      /// <summary>
      /// Ініціалізує новий екземпляр класу <see cref="CoreModule"/>.
      /// </summary>
      /// <param name="regionManager">Менеджер областей.</param>
      /// <param name="unityContainer">Контейнер IoC.</param>
      /// <param name="eventAggregator">Агрегатор подій.</param>
        public CoreModule(IRegionManager regionManager, IUnityContainer unityContainer,
            IEventAggregator eventAggregator)
            : base(regionManager, unityContainer, eventAggregator)
        {
        }

        /// <summary>
        /// Реєстрація інтерфейсів.
        /// </summary>
        protected override void RegistreInterfaces()
        {
            base.RegistreInterfaces();
            UnityContainer.RegisterType<IARMToolboxViewModel, ARMToolboxBase>();
            UnityContainer.RegisterType<IARMValidationAdaptor, ARMValidationAdaptor>();
        }

        /// <summary>
        /// Внутрішня ініціалізація.
        /// </summary>
        protected override void InternalInitialize()
        {
            base.InternalInitialize();
            //Dispatcher.CurrentDispatcher.BeginInvoke(new Action(() => ARMModelsPropertyCache.Instance.Initialize()));
            ARMModelsPropertyCache.Instance.Initialize();
        }
    } //end CoreModule
} //end namespace ARM.Core
