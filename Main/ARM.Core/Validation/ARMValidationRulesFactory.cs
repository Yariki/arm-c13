///////////////////////////////////////////////////////////
//  ARMValidationRulesFactory.cs
//  Implementation of the Class ARMValidationRulesFactory
//  Generated by Enterprise Architect
//  Created on:      29-Mar-2014 4:59:44 PM
///////////////////////////////////////////////////////////

using System;
using ARM.Core.Attributes;
using ARM.Core.Interfaces;
using ARM.Core.Validation.Rules;

namespace ARM.Core.Validation
{
    public class ARMValidationRulesFactory
    {

        protected ARMValidationRulesFactory()
        {
        }

        private static Lazy<ARMValidationRulesFactory> _instance = new Lazy<ARMValidationRulesFactory>(() => new ARMValidationRulesFactory()); 

        public static ARMValidationRulesFactory Instance
        {
            get { return _instance.Value; }
        }

        ///
        /// <param name="attr"></param>
        public IARMValidationRule GetRule(IARMValidationAttribute attr)
        {
            if (attr is ARMMaxAttribute)
            {
                var maxAttr = attr as ARMMaxAttribute;
                return new ARMMaxValidationRule(maxAttr.Min,maxAttr.Max);
            }
            return null;
        }
    }//end ARMValidationRulesFactory
}//end namespace Validation