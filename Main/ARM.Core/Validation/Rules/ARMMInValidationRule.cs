///////////////////////////////////////////////////////////
//  ARMMInValidationRule.cs
//  Implementation of the Class ARMMInValidationRule
//  Generated by Enterprise Architect
//  Created on:      29-Mar-2014 4:59:42 PM
///////////////////////////////////////////////////////////

using System;

namespace ARM.Core.Validation.Rules
{
    public class ARMMinValidationRule : ARMNumericValidationRule
    {
        public ARMMinValidationRule()
        {
        }

        ~ARMMinValidationRule()
        {
        }

        protected override ARM.Core.Interfaces.IARMValidationResult InternalEvalute(object val)
        {
            var result = new ARMValidationResult() { IsValid = true };
            if (val != null)
            {
                double v = Convert.ToDouble(val);
                result.IsValid = Min < v;
                if (!result.IsValid)
                {
                    result.AddMessage(string.Format("Value shouldn't be less {0}.", Min));
                }
            }
            return result;
        }

        ///
        /// <param name="min"></param>
        /// <param name="max"></param>
        public ARMMinValidationRule(double min, double max)
            : base(min, max)
        {
        }
    }//end ARMMInValidationRule
}//end namespace Rules